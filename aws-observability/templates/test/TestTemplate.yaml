---
Global:
  TemplatePath: "../sumologic_observability.master.template.yaml"
  TestProjectName: MasterTemplate
  ParallelTestsRun: 4
  GlobalParameters:
    Section1eSumoLogicResourceRemoveOnDeleteStack: 'true'
    Section2aAccountAlias: 'testenv'
Tests:
  - TestName: defaultparamnoaliasnocsv
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us1'
        Section1bSumoLogicAccessID: '${ENTERPRISE_US1_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${ENTERPRISE_US1_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US1_ENTERPRISE_ORG_ID}'
        Section2aAccountAlias: 'testenv'
        Section2bAccountAliasMappingS3URL: ''
        Section4bMetricsNameSpaces: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS, AWS/EC2'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddApiIdField
            - CreateCommonResources.AddApiNameField
            - CreateCommonResources.AddCacheClusterIdField
            - CreateCommonResources.AddClusterNameField
            - CreateCommonResources.AddDBIdentifierField
            - CreateCommonResources.AddFunctionNameField
            - CreateCommonResources.AddInstanceIdField
            - CreateCommonResources.AddLoadBalancerField
            - CreateCommonResources.AddLoadBalancerNameField
            - CreateCommonResources.AddNETLoadBalancerField
            - CreateCommonResources.AddQueueNameField
            - CreateCommonResources.AddTableNameField
            - CreateCommonResources.AddTopicNameField
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CommonCloudTrail
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.KinesisFirehoseMetricsStack
            - CreateCommonResources.KinesisFirehoseMetricsSource
            - CreateCommonResources.KinesisFirehoseLogsStack
            - CreateCommonResources.KinesisFirehoseLogsSource
            - CreateCommonResources.KinesisFirehoseMetricsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroup
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStreamS3
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambda
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambdaRole
            - CreateCommonResources.KinesisFirehoseLogsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroup
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStreamS3
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.SubscriptionFilter
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSSubscription
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.InventorySource
            - RootCauseAppStack.XraySource
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.InvokeLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTrigger
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTriggerPermission
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.sumoIAMPassRolePolicy
            - sumoEC2MetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoOverview
            - sumoEC2MetricsAppStack.sumoMonitorAlerts
            - sumoAlbMetricsAppStack.sumoApp
            - sumoElbMetricsAppStack.sumoApp
            - sumoDynamoDBMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoRdsMetricsAppStack.sumoApp
            - sumoApiGatewayMetricsAppStack.sumoApp
            - sumoSNSAppStack.sumoApp
            - sumoSQSAppStack.sumoApp
            - RootCauseAppStack.CloudTrailDevOps
            - sumoLambdaMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.sumoApp
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoElasticCacheMetricsAppStack.sumoApp
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - sumoNlbMetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoAppCW
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - CreateCommonResources.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroupARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroupARN
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - CreateCommonResources.AccountAlias
            - CreateCommonResources.CollectorName
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "testenv"
            AccountAliasMappingS3URL: ''
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateKinesisFirehoseMetricsSource: 'Yes'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'Yes'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: '/elasticloadbalancing/ap-southeast-1/*'
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'Yes'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: 'classicloadbalancing/AWSLogs/'
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'Yes'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: '/CloudTrail/ap-southeast-1/*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'Yes'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
          CreateCommonResources.KinesisFirehoseMetricsStack:
            Section2aCreateS3Bucket: 'No'
            Section1bNamespaceFilter: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS'
          CreateCommonResources.KinesisFirehoseLogsStack:
            Section2aCreateS3Bucket: 'No'
          AutoEnableOptions:
            ALBAutoEnableS3Logs: 'Yes'
            ALBAutoEnableS3LogsOptions: "Both"
            ALBS3LogsBucketName: 'aws-observability-logs'
            ELBAutoEnableS3Logs: 'Yes'
            ELBAutoEnableS3LogsOptions: "Both"
            ELBS3LogsBucketName: 'aws-observability-logs'
            AutoSubscribeLogGroups: 'Yes'
            AutoSubscribeLogGroupsOptions: 'Both'
            AutoSubscribeDestinationARNType: 'Kinesis'
            AutoSubscribeDestinationARNValue: 'arn:aws:firehose:'
            AutoSubscribeLogGroupPattern: 'lambda'
            AutoSubscribeRoleArn: "arn:aws:iam::"
          AutoEnableOptions.AutoEnableS3LogsAlbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoEnableS3LogsElbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources:
            UseExistingLogs: 'true'
            DestinationArnType: 'Kinesis'
            DestinationArnValue: 'arn:aws:firehose:'
            LogGroupPattern: '\/aws\/(lambda|apigateway|rds)'
            RoleArn: "arn:aws:iam::"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'Yes'
          sumoAlbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoElbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'Yes'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'testenv'
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: '*cloudwatch-logs*'
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: defaultparamnocloudtrailvalidmappingcsv
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us1'
        Section1bSumoLogicAccessID: '${ENTERPRISE_US1_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${ENTERPRISE_US1_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US1_ENTERPRISE_ORG_ID}'
        Section2aAccountAlias: 'testenv'
        Section2bAccountAliasMappingS3URL: 'https://mappingbucketawso.s3.amazonaws.com/mapping.csv'
        Section4bMetricsNameSpaces: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddApiIdField
            - CreateCommonResources.AddApiNameField
            - CreateCommonResources.AddCacheClusterIdField
            - CreateCommonResources.AddClusterNameField
            - CreateCommonResources.AddDBIdentifierField
            - CreateCommonResources.AddFunctionNameField
            - CreateCommonResources.AddInstanceIdField
            - CreateCommonResources.AddLoadBalancerField
            - CreateCommonResources.AddLoadBalancerNameField
            - CreateCommonResources.AddNETLoadBalancerField
            - CreateCommonResources.AddQueueNameField
            - CreateCommonResources.AddTableNameField
            - CreateCommonResources.AddTopicNameField
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CommonCloudTrail
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.KinesisFirehoseMetricsStack
            - CreateCommonResources.KinesisFirehoseMetricsSource
            - CreateCommonResources.KinesisFirehoseLogsStack
            - CreateCommonResources.KinesisFirehoseLogsSource
            - CreateCommonResources.KinesisFirehoseMetricsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroup
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStreamS3
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambda
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambdaRole
            - CreateCommonResources.KinesisFirehoseLogsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroup
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStreamS3
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.SubscriptionFilter
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSSubscription
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.InventorySource
            - RootCauseAppStack.XraySource
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.InvokeLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTrigger
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTriggerPermission
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.sumoIAMPassRolePolicy
            - sumoEC2MetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoOverview
            - sumoEC2MetricsAppStack.sumoMonitorAlerts
            - sumoAlbMetricsAppStack.sumoApp
            - sumoElbMetricsAppStack.sumoApp
            - sumoDynamoDBMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoRdsMetricsAppStack.sumoApp
            - sumoApiGatewayMetricsAppStack.sumoApp
            - sumoSNSAppStack.sumoApp
            - sumoSQSAppStack.sumoApp
            - RootCauseAppStack.CloudTrailDevOps
            - sumoLambdaMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.sumoApp
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoElasticCacheMetricsAppStack.sumoApp
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - sumoNlbMetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoAppCW
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - CreateCommonResources.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroupARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroupARN
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - CreateCommonResources.AccountAlias
            - CreateCommonResources.CollectorName
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: ""
            AccountAliasMappingS3URL: 'https://mappingbucketawso.s3.amazonaws.com/mapping.csv'
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateKinesisFirehoseMetricsSource: 'Yes'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'Yes'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: '/elasticloadbalancing/ap-southeast-1/*'
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'Yes'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: 'classicloadbalancing/AWSLogs'
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'Yes'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: '/CloudTrail/ap-southeast-1/*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'Yes'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
          CreateCommonResources.KinesisFirehoseMetricsStack:
            Section2aCreateS3Bucket: 'No'
            Section1bNamespaceFilter: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS'
          CreateCommonResources.KinesisFirehoseLogsStack:
            Section2aCreateS3Bucket: 'No'
          AutoEnableOptions:
            ALBAutoEnableS3Logs: 'Yes'
            ALBAutoEnableS3LogsOptions: "Both"
            ALBS3LogsBucketName: 'aws-observability-logs'
            ELBAutoEnableS3Logs: 'Yes'
            ELBAutoEnableS3LogsOptions: "Both"
            ELBS3LogsBucketName: 'aws-observability-logs'
            AutoSubscribeLogGroups: 'Yes'
            AutoSubscribeLogGroupsOptions: 'Both'
            AutoSubscribeDestinationARNType: 'Kinesis'
            AutoSubscribeDestinationARNValue: 'arn:aws:firehose:'
            AutoSubscribeLogGroupPattern: 'lambda'
            AutoSubscribeRoleArn: "arn:aws:iam::"
          AutoEnableOptions.AutoEnableS3LogsAlbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoEnableS3LogsElbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources:
            UseExistingLogs: 'true'
            DestinationArnType: 'Kinesis'
            DestinationArnValue: 'arn:aws:firehose:'
            LogGroupPattern: 'lambda'
            RoleArn: "arn:aws:iam::"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'Yes'
          sumoAlbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoElbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSNSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSQSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'Yes'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'testenv'
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: '*cloudwatch-logs*'
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: defaultparamnocloudtrailinvalidmappingcsv
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us1'
        Section1bSumoLogicAccessID: '${ENTERPRISE_US1_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${ENTERPRISE_US1_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US1_ENTERPRISE_ORG_ID}'
        Section2aAccountAlias: 'testenv'
        Section2bAccountAliasMappingS3URL: 'https://mappingbucketawso.s3.amazonaws.com/mapping_invalid.csv'
        Section4bMetricsNameSpaces: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.AddApiIdField
            - CreateCommonResources.AddApiNameField
            - CreateCommonResources.AddCacheClusterIdField
            - CreateCommonResources.AddClusterNameField
            - CreateCommonResources.AddDBIdentifierField
            - CreateCommonResources.AddFunctionNameField
            - CreateCommonResources.AddInstanceIdField
            - CreateCommonResources.AddLoadBalancerField
            - CreateCommonResources.AddLoadBalancerNameField
            - CreateCommonResources.AddNETLoadBalancerField
            - CreateCommonResources.AddQueueNameField
            - CreateCommonResources.AddTableNameField
            - CreateCommonResources.AddTopicNameField
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CommonCloudTrail
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.KinesisFirehoseMetricsStack
            - CreateCommonResources.KinesisFirehoseMetricsSource
            - CreateCommonResources.KinesisFirehoseLogsStack
            - CreateCommonResources.KinesisFirehoseLogsSource
            - CreateCommonResources.KinesisFirehoseMetricsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroup
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStreamS3
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambda
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambdaRole
            - CreateCommonResources.KinesisFirehoseLogsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroup
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStreamS3
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.SubscriptionFilter
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSSubscription
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.InventorySource
            - RootCauseAppStack.XraySource
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.InvokeLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTrigger
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTriggerPermission
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.sumoIAMPassRolePolicy
            - sumoEC2MetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoOverview
            - sumoEC2MetricsAppStack.sumoMonitorAlerts
            - sumoAlbMetricsAppStack.sumoApp
            - sumoElbMetricsAppStack.sumoApp
            - sumoDynamoDBMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoRdsMetricsAppStack.sumoApp
            - sumoApiGatewayMetricsAppStack.sumoApp
            - sumoSNSAppStack.sumoApp
            - sumoSQSAppStack.sumoApp
            - RootCauseAppStack.CloudTrailDevOps
            - sumoLambdaMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.sumoApp
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - sumoNlbMetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoAppCW
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - CreateCommonResources.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroupARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroupARN
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - CreateCommonResources.AccountAlias
            - CreateCommonResources.CollectorName
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: ""
            AccountAliasMappingS3URL: 'https://mappingbucketawso.s3.amazonaws.com/mapping_invalid.csv'
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateKinesisFirehoseMetricsSource: 'Yes'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'Yes'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: '/elasticloadbalancing/ap-southeast-1/*'
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'Yes'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: 'classicloadbalancing/AWSLogs/'
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'Yes'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: '/CloudTrail/ap-southeast-1/*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'Yes'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
          CreateCommonResources.KinesisFirehoseMetricsStack:
            Section2aCreateS3Bucket: 'No'
            Section1bNamespaceFilter: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SQS, AWS/SNS'
          CreateCommonResources.KinesisFirehoseLogsStack:
            Section2aCreateS3Bucket: 'No'
          AutoEnableOptions:
            ALBAutoEnableS3Logs: 'Yes'
            ALBAutoEnableS3LogsOptions: "Both"
            ALBS3LogsBucketName: 'aws-observability-logs'
            ELBAutoEnableS3Logs: 'Yes'
            ELBAutoEnableS3LogsOptions: "Both"
            ELBS3LogsBucketName: 'aws-observability-logs'
            AutoSubscribeLogGroups: 'Yes'
            AutoSubscribeLogGroupsOptions: 'Both'
            AutoSubscribeDestinationARNType: 'Kinesis'
            AutoSubscribeDestinationARNValue: 'arn:aws:firehose:'
            AutoSubscribeLogGroupPattern: 'lambda'
            AutoSubscribeRoleArn: "arn:aws:iam::"
          AutoEnableOptions.AutoEnableS3LogsAlbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoEnableS3LogsElbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources:
            UseExistingLogs: 'true'
            DestinationArnType: 'Kinesis'
            DestinationArnValue: 'arn:aws:firehose:'
            LogGroupPattern: 'lambda'
            RoleArn: "arn:aws:iam::"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'Yes'
          sumoAlbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoElbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSNSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSQSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'Yes'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'testenv'
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: '*cloudwatch-logs*'
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: nothingtoinstall
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us2'
        Section1bSumoLogicAccessID: '${PROFESSIONAL_US2_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${PROFESSIONAL_US2_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US2_PROFESSIONAL_ORG_ID}'
        Section2aAccountAlias: 'test2env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'No'
        Section4aCreateMetricsSourceOptions: 'None'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'None'
        Section5bALBCreateLogSource: 'No'
        Section6aCreateCloudTrailLogSource: 'No'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'None'
        Section8aRootCauseExplorerOptions: 'None'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'None'
        Section9bELBCreateLogSource: 'No'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - sumoApiGatewayMetricsAppStack.MetricRule
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test2env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateALBLogSource: 'No'
            CreateALBS3Bucket: 'No'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: ''
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'No'
            CreateELBS3Bucket: 'No'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: ''
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'No'
            CreateCloudTrailBucket: 'No'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: ''
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'No'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'No'
          sumoAlbMetricsAppStack:
            Section2aAccountAlias: 'test2env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: ''
          sumoElbMetricsAppStack:
            Section2aAccountAlias: 'test2env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: ''
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'No'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'No'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'No'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test2env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: ''
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: ''
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: nocloudtrailandinventory
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us2'
        Section1bSumoLogicAccessID: '${FREE_ACCOUNT_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${FREE_ACCOUNT_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US2_FREE_ORG_ID}'
        Section2aAccountAlias: 'test3env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'No'
        Section4aCreateMetricsSourceOptions: 'CloudWatch Metrics Source'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'New'
        Section5bALBCreateLogSource: 'Yes'
        Section6aCreateCloudTrailLogSource: 'No'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'Lambda Log Forwarder'
        Section7cAutoSubscribeLogGroupsOptions: 'New'
        Section8aRootCauseExplorerOptions: 'Xray Source'
        Section4bMetricsNameSpaces: 'AWS/ElastiCache, AWS/ELB, AWS/NetworkELB, AWS/ApplicationELB, AWS/RDS, AWS/SQS, AWS/EC2, AWS/SNS'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'New'
        Section9bELBCreateLogSource: 'Yes'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.CloudWatchMetricsFirstStack
            - CreateCommonResources.CloudWatchMetricsSecondStack
            - CreateCommonResources.CloudWatchMetricsThirdStack
            - CreateCommonResources.CloudWatchMetricsFirstStack.FirstCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsFirstStack.FifthCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsSecondStack.SecondCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsSecondStack.ThirdCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsSecondStack.FourthCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsSecondStack.FifthCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsThirdStack.FirstCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsThirdStack.SecondCloudwatchMetricsSource
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudWatchEventFunction
            - CreateCommonResources.CloudWatchHTTPSource
            - CreateCommonResources.CloudWatchEventFunction.SumoCWDeadLetterQueue
            - CreateCommonResources.CloudWatchEventFunction.SumoCWEmailSNSTopic
            - CreateCommonResources.CloudWatchEventFunction.SumoCWEventsInvokeLambdaPermission
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLambdaExecutionRole
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLambdaPermission
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogGroup
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogSubsriptionFilter
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogsLambda
            - CreateCommonResources.CloudWatchEventFunction.SumoCWProcessDLQLambda
            - CreateCommonResources.CloudWatchEventFunction.SumoCWProcessDLQScheduleRule
            - CreateCommonResources.CloudWatchEventFunction.SumoCWSpilloverAlarm
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoCWLambdaInvokePermission
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTrigger
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTriggerPermission
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorRole
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.XraySource
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - CreateCommonResources.CloudWatchLambdaARN
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogsLambdaArn
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test3env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'Yes'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ElastiCache, AWS/ELB, AWS/NetworkELB, AWS/ApplicationELB, AWS/RDS, AWS/SQS"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'Yes'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: '/elasticloadbalancing/ap-southeast-1/*'
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'Yes'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: 'classicloadbalancing/AWSLogs/'
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'No'
            CreateCloudTrailBucket: 'No'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: ''
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'Yes'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'No'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          AutoEnableOptions:
            ALBAutoEnableS3Logs: 'Yes'
            ALBS3LogsBucketName: 'aws-observability-logs'
            ELBAutoEnableS3Logs: 'Yes'
            ELBS3LogsBucketName: 'aws-observability-logs'
            AutoSubscribeLogGroups: 'Yes'
            AutoSubscribeLogGroupsOptions: 'New'
            AutoSubscribeDestinationARNType: 'Lambda'
            AutoSubscribeDestinationARNValue: 'arn:aws:lambda:'
            AutoSubscribeLogGroupPattern: 'lambda'
            AutoSubscribeRoleArn: ""
          AutoEnableOptions.AutoEnableS3LogsAlbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'New'
          AutoEnableOptions.AutoEnableS3LogsElbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'New'
          AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources:
            UseExistingLogs: 'false'
            DestinationArnType: 'Lambda'
            DestinationArnValue: 'arn:aws:lambda:'
            LogGroupPattern: 'lambda'
            RoleArn: ""
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'No'
          sumoAlbMetricsAppStack:
            Section2aAccountAlias: 'test3env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoElbMetricsAppStack:
            Section2aAccountAlias: 'test3env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSNSAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSQSAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'No'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'No'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test3env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: ''
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: '*cloudwatch-logs*'
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: ''
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: onlycloudtrailinventorysource
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us1'
        Section1bSumoLogicAccessID: '${ENTERPRISE_US1_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${ENTERPRISE_US1_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US1_ENTERPRISE_ORG_ID}'
        Section2aAccountAlias: 'test4env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'No'
        Section4aCreateMetricsSourceOptions: 'Kinesis Firehose Metrics Source'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'New'
        Section5bALBCreateLogSource: 'No'
        Section6aCreateCloudTrailLogSource: 'Yes'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'Lambda Log Forwarder'
        Section7cAutoSubscribeLogGroupsOptions: 'Existing'
        Section8aRootCauseExplorerOptions: 'Inventory Source'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'New'
        Section9bELBCreateLogSource: 'No'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CommonCloudTrail
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSSubscription
            - CreateCommonResources.CloudWatchEventFunction
            - CreateCommonResources.CloudWatchHTTPSource
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.InventorySource
            - CreateCommonResources.CloudWatchEventFunction.SumoCWDeadLetterQueue
            - CreateCommonResources.CloudWatchEventFunction.SumoCWEmailSNSTopic
            - CreateCommonResources.CloudWatchEventFunction.SumoCWEventsInvokeLambdaPermission
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLambdaExecutionRole
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLambdaPermission
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogGroup
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogSubsriptionFilter
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogsLambda
            - CreateCommonResources.CloudWatchEventFunction.SumoCWProcessDLQLambda
            - CreateCommonResources.CloudWatchEventFunction.SumoCWProcessDLQScheduleRule
            - CreateCommonResources.CloudWatchEventFunction.SumoCWSpilloverAlarm
            - CreateCommonResources.KinesisFirehoseMetricsStack
            - CreateCommonResources.KinesisFirehoseMetricsSource
            - CreateCommonResources.KinesisFirehoseMetricsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroup
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStreamS3
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambda
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambdaRole
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - CreateCommonResources.CloudWatchLambdaARN
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogsLambdaArn
            - CreateCommonResources.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroupARN
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test4env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: ''
            CloudWatchMetricsNameSpaces: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: ""
            CreateALBLogSource: 'No'
            CreateALBS3Bucket: 'No'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: ''
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'No'
            CreateELBS3Bucket: 'No'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: ''
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'Yes'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: '/CloudTrail/ap-southeast-1/*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'Yes'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'Yes'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          CreateCommonResources.KinesisFirehoseMetricsStack:
            Section2aCreateS3Bucket: 'No'
            Section1bNamespaceFilter: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'No'
          sumoAlbMetricsAppStack:
            Section2aAccountAlias: 'test4env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: ''
          sumoElbMetricsAppStack:
            Section2aAccountAlias: 'test4env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: ''
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'No'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'No'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test4env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: '*cloudwatch-logs*'
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: existingsourcewithalbbucket
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us2'
        Section1bSumoLogicAccessID: '${FREE_ACCOUNT_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${FREE_ACCOUNT_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US2_FREE_ORG_ID}'
        Section2aAccountAlias: 'test5env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'No'
        Section4aCreateMetricsSourceOptions: 'None'
        Section4cCloudWatchExistingSourceAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'Existing'
        Section5bALBCreateLogSource: 'Yes'
        Section5dALBS3LogsBucketName: 'cf-templates-1qpf3unpuo1hw-ap-southeast-1'
        Section5eALBS3BucketPathExpression: '*abc*'
        Section6aCreateCloudTrailLogSource: 'Yes'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'None'
        Section7bLambdaCloudWatchLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763257213'
        Section7cAutoSubscribeLogGroupsOptions: 'New'
        Section8aRootCauseExplorerOptions: 'Xray Source'
        Section9bELBCreateLogSource: 'No'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CommonCloudTrail
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSTopic
            - CreateCommonResources.ALBSNSpolicy
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSSubscription
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.SumoLambdaRole
            - sumoAlbMetricsAppStack.SumoALBMetricsUpdateSource
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoLambdaMetricsAppStack.SumoHTTPUpdateSource
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.XraySource
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - sumoLambdaMetricsAppStack.ExistingCloudWatchLogSourceName
            - sumoAlbMetricsAppStack.ExistingMetricSourceName
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test5env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: ''
            CloudWatchMetricsNameSpaces: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: ""
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'No'
            ALBS3LogsBucketName: "cf-templates-1qpf3unpuo1hw-ap-southeast-1"
            ALBS3BucketPathExpression: '/elasticloadbalancing/ap-southeast-1/*'
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'Yes'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: '/CloudTrail/ap-southeast-1/*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'No'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          AutoEnableOptions:
            ALBAutoEnableS3Logs: 'Yes'
            ALBS3LogsBucketName: 'cf-templates-1qpf3unpuo1hw-ap-southeast-1'
            AutoSubscribeLogGroups: 'No'
          AutoEnableOptions.AutoEnableS3LogsAlbAWSResources:
            BucketName: 'cf-templates-1qpf3unpuo1hw-ap-southeast-1'
            AutoEnableResourceOptions: 'Existing'
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'No'
          sumoAlbMetricsAppStack:
            Section2aAccountAlias: 'test5env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'No'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'No'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test5env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763257213'
            Section6bCloudWatchLogsSourceName: ''
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: existingsourcewithelbbucket
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us2'
        Section1bSumoLogicAccessID: '${FREE_ACCOUNT_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${FREE_ACCOUNT_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US2_FREE_ORG_ID}'
        Section2aAccountAlias: 'test9env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'No'
        Section4aCreateMetricsSourceOptions: 'None'
        Section4cCloudWatchExistingSourceAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'None'
        Section5bALBCreateLogSource: 'No'
        Section6aCreateCloudTrailLogSource: 'Yes'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'None'
        Section7bLambdaCloudWatchLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763257213'
        Section7cAutoSubscribeLogGroupsOptions: 'New'
        Section8aRootCauseExplorerOptions: 'Xray Source'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'Existing'
        Section9bELBCreateLogSource: 'Yes'
        Section9dELBS3LogsBucketName: 'cf-templates-1qpf3unpuo1hw-ap-southeast-1'
        Section9eELBS3BucketPathExpression: 'elblogs'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CommonCloudTrail
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSTopic
            - CreateCommonResources.ELBSNSpolicy
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSSubscription
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.SumoLambdaRole
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoLambdaMetricsAppStack.SumoHTTPUpdateSource
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.SumoELBMetricsUpdateSource
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.XraySource
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.SumoALBMetricsUpdateSource
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - sumoAlbMetricsAppStack.ExistingMetricSourceName
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - sumoLambdaMetricsAppStack.ExistingCloudWatchLogSourceName
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test9env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: ''
            CloudWatchMetricsNameSpaces: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: ""
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'No'
            ELBS3LogsBucketName: "cf-templates-1qpf3unpuo1hw-ap-southeast-1"
            ELBS3BucketPathExpression: 'elblogs/AWSLogs/'
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'Yes'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: '/CloudTrail/ap-southeast-1/*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'No'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          AutoEnableOptions:
            ELBAutoEnableS3Logs: 'Yes'
            ELBS3LogsBucketName: 'cf-templates-1qpf3unpuo1hw-ap-southeast-1'
            AutoSubscribeLogGroups: 'No'
          AutoEnableOptions.AutoEnableS3LogsElbAWSResources:
            BucketName: 'cf-templates-1qpf3unpuo1hw-ap-southeast-1'
            AutoEnableResourceOptions: 'Existing'
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'No'
          sumoElbMetricsAppStack:
            Section2aAccountAlias: 'test9env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'No'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'No'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test9env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763257213'
            Section6bCloudWatchLogsSourceName: ''
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: existingcloudtrailbucket
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us1'
        Section1bSumoLogicAccessID: '${ENTERPRISE_US1_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${ENTERPRISE_US1_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US1_ENTERPRISE_ORG_ID}'
        Section2aAccountAlias: 'test6env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'No'
        Section4aCreateMetricsSourceOptions: 'CloudWatch Metrics Source'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'None'
        Section5bALBCreateLogSource: 'Yes'
        Section6aCreateCloudTrailLogSource: 'Yes'
        Section6cCloudTrailLogsBucketName: 'cf-templates-1qpf3unpuo1hw-ap-southeast-1'
        Section6dCloudTrailBucketPathExpression: '*abc*'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'None'
        Section8aRootCauseExplorerOptions: 'Inventory Source'
        Section4bMetricsNameSpaces: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/EC2'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'None'
        Section9bELBCreateLogSource: 'Yes'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.CloudWatchMetricsFirstStack
            - CreateCommonResources.CloudWatchMetricsSecondStack
            - CreateCommonResources.CloudWatchMetricsThirdStack
            - CreateCommonResources.CloudWatchMetricsFirstStack.SecondCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsFirstStack.ThirdCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsSecondStack.SecondCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsSecondStack.FifthCloudwatchMetricsSource
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSTopic
            - CreateCommonResources.CloudTrailSNSpolicy
            - CreateCommonResources.CloudTrailSNSSubscription
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.InventorySource
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test6env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'Yes'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'Yes'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: '*AWSLogs/*/elasticloadbalancing/*'
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'Yes'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: 'classicloadbalancing/AWSLogs/'
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'No'
            CloudTrailLogsBucketName: "cf-templates-1qpf3unpuo1hw-ap-southeast-1"
            CloudTrailBucketPathExpression: '*abc*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'No'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'No'
          sumoAlbMetricsAppStack:
            Section2aAccountAlias: 'test6env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoElbMetricsAppStack:
            Section2aAccountAlias: 'test6env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'No'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'No'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test6env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: ''
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: existingcloudtrailalbsource
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us2'
        Section1bSumoLogicAccessID: '${PROFESSIONAL_US2_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${PROFESSIONAL_US2_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US2_PROFESSIONAL_ORG_ID}'
        Section2aAccountAlias: 'test7env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'Yes'
        Section4aCreateMetricsSourceOptions: 'Kinesis Firehose Metrics Source'
        Section4cCloudWatchExistingSourceAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'Both'
        Section5bALBCreateLogSource: 'No'
        Section5cALBLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section5dALBS3LogsBucketName: 'newapigateway'
        Section6aCreateCloudTrailLogSource: 'No'
        Section6bCloudTrailLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'None'
        Section8aRootCauseExplorerOptions: 'Both'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'None'
        Section9bELBCreateLogSource: 'No'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.AddApiIdField
            - CreateCommonResources.AddApiNameField
            - CreateCommonResources.AddCacheClusterIdField
            - CreateCommonResources.AddClusterNameField
            - CreateCommonResources.AddDBIdentifierField
            - CreateCommonResources.AddFunctionNameField
            - CreateCommonResources.AddInstanceIdField
            - CreateCommonResources.AddLoadBalancerField
            - CreateCommonResources.AddLoadBalancerNameField
            - CreateCommonResources.AddNETLoadBalancerField
            - CreateCommonResources.AddQueueNameField
            - CreateCommonResources.AddTableNameField
            - CreateCommonResources.AddTopicNameField
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.SumoLogicSourceRole
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.SumoLambdaRole
            - sumoEC2MetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoOverview
            - sumoEC2MetricsAppStack.sumoMonitorAlerts
            - sumoAlbMetricsAppStack.sumoApp
            - sumoAlbMetricsAppStack.SumoALBLogsUpdateSource
            - sumoDynamoDBMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoApiGatewayMetricsAppStack.sumoApp
            - sumoSNSAppStack.sumoApp
            - sumoSQSAppStack.sumoApp
            - sumoLambdaMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.SumoCloudTrailLogsUpdateSource
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.sumoApp
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.sumoApp
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - sumoNlbMetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoAppCW
            - CreateCommonResources.KinesisFirehoseMetricsStack
            - CreateCommonResources.KinesisFirehoseMetricsSource
            - CreateCommonResources.KinesisFirehoseMetricsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.FailedDataBucket
            - CreateCommonResources.KinesisFirehoseMetricsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroup
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStreamS3
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambda
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambdaRole
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.CloudTrailDevOps
            - RootCauseAppStack.InventorySource
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.XraySource
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - sumoLambdaMetricsAppStack.ExistingCloudTrailLogSourceName
            - sumoAlbMetricsAppStack.ExistingLogSourceName
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - CreateCommonResources.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroupARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.FailedDataBucketArn
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test7env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateALBLogSource: 'No'
            CreateALBS3Bucket: 'No'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: ''
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateCloudTrailLogSource: 'No'
            CreateCloudTrailBucket: 'No'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: ''
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'Yes'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          CreateCommonResources.KinesisFirehoseMetricsStack:
            Section2aCreateS3Bucket: 'Yes'
            Section1bNamespaceFilter: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'Yes'
          sumoAlbMetricsAppStack:
            Section2aAccountAlias: 'test7env'
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
            Section5bALBLogsSourceName: ''
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoSNSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoSQSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          RootCauseAppStack:
            Section2aInstallApp: 'Yes'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test7env'
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
            Section5bCloudTrailLogsSourceName: ''
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: ''
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: existingcloudtrailelbsource
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us2'
        Section1bSumoLogicAccessID: '${PROFESSIONAL_US2_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${PROFESSIONAL_US2_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US2_PROFESSIONAL_ORG_ID}'
        Section2aAccountAlias: 'test7env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'Yes'
        Section4aCreateMetricsSourceOptions: 'Kinesis Firehose Metrics Source'
        Section4cCloudWatchExistingSourceAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'None'
        Section5bALBCreateLogSource: 'No'
        Section6aCreateCloudTrailLogSource: 'No'
        Section6bCloudTrailLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'None'
        Section8aRootCauseExplorerOptions: 'Both'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'Both'
        Section9bELBCreateLogSource: 'No'
        Section9cELBLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section9dELBS3LogsBucketName: 'anemaelblogs-ap-southeast-1'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.AddApiIdField
            - CreateCommonResources.AddApiNameField
            - CreateCommonResources.AddCacheClusterIdField
            - CreateCommonResources.AddClusterNameField
            - CreateCommonResources.AddDBIdentifierField
            - CreateCommonResources.AddFunctionNameField
            - CreateCommonResources.AddInstanceIdField
            - CreateCommonResources.AddLoadBalancerField
            - CreateCommonResources.AddLoadBalancerNameField
            - CreateCommonResources.AddNETLoadBalancerField
            - CreateCommonResources.AddQueueNameField
            - CreateCommonResources.AddTableNameField
            - CreateCommonResources.AddTopicNameField
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.SumoLogicSourceRole
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.SumoLambdaRole
            - sumoEC2MetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoOverview
            - sumoEC2MetricsAppStack.sumoMonitorAlerts
            - sumoElbMetricsAppStack.sumoApp
            - sumoElbMetricsAppStack.SumoELBLogsUpdateSource
            - sumoDynamoDBMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoApiGatewayMetricsAppStack.sumoApp
            - sumoSNSAppStack.sumoApp
            - sumoSQSAppStack.sumoApp
            - sumoLambdaMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.SumoCloudTrailLogsUpdateSource
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.sumoApp
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.sumoApp
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - sumoNlbMetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoAppCW
            - CreateCommonResources.KinesisFirehoseMetricsStack
            - CreateCommonResources.KinesisFirehoseMetricsSource
            - CreateCommonResources.KinesisFirehoseMetricsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.FailedDataBucket
            - CreateCommonResources.KinesisFirehoseMetricsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroup
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStreamS3
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambda
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambdaRole
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.CloudTrailDevOps
            - RootCauseAppStack.InventorySource
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.XraySource
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.sumoApp
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - sumoLambdaMetricsAppStack.ExistingCloudTrailLogSourceName
            - sumoElbMetricsAppStack.ExistingLogSourceName
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - CreateCommonResources.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroupARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.FailedDataBucketArn
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test7env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateELBLogSource: 'No'
            CreateELBS3Bucket: 'No'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: ''
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'No'
            CreateCloudTrailBucket: 'No'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: ''
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'No'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'Yes'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          CreateCommonResources.KinesisFirehoseMetricsStack:
            Section2aCreateS3Bucket: 'Yes'
            Section1bNamespaceFilter: "AWS/ApplicationELB, AWS/ApiGateway, AWS/DynamoDB, AWS/Lambda, AWS/RDS, AWS/ECS, AWS/ElastiCache, AWS/ELB, AWS/NetworkELB"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'Yes'
          sumoElbMetricsAppStack:
            Section2aAccountAlias: 'test7env'
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
            Section5bELBLogsSourceName: ''
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoSNSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoSQSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          RootCauseAppStack:
            Section2aInstallApp: 'Yes'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test7env'
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
            Section5bCloudTrailLogsSourceName: ''
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: ''
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: 'test source 2'
            Section3bCloudTrailSourceUpdated: 'Yes'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: createsourceexibucketexisources
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us1'
        Section1bSumoLogicAccessID: '${ENTERPRISE_US1_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${ENTERPRISE_US1_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US1_ENTERPRISE_ORG_ID}'
        Section2aAccountAlias: 'test8env'
        Section2bAccountAliasMappingS3URL: ''
        Section3aInstallObservabilityApps: 'No'
        Section4aCreateMetricsSourceOptions: 'CloudWatch Metrics Source'
        Section4bMetricsNameSpaces: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SNS, AWS/SQS'
        Section4cCloudWatchExistingSourceAPIUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'None'
        Section5bALBCreateLogSource: 'Yes'
        Section5cALBLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section5dALBS3LogsBucketName: 'newapigateway'
        Section5eALBS3BucketPathExpression: '*abc*'
        Section6aCreateCloudTrailLogSource: 'Yes'
        Section6bCloudTrailLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section6cCloudTrailLogsBucketName: 'newapigateway'
        Section6dCloudTrailBucketPathExpression: '*abc*'
        Section7aLambdaCreateCloudWatchLogsSourceOptions: 'Both (Switch from Lambda Log Forwarder to Kinesis Firehose Log Source)'
        Section7bLambdaCloudWatchLogsSourceUrl: "https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763257213"
        Section7cAutoSubscribeLogGroupsOptions: "Both"
        Section8aRootCauseExplorerOptions: 'Inventory Source'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'None'
        Section9bELBCreateLogSource: 'Yes'
        Section9cELBLogsSourceUrl: 'https://api.us2.sumologic.com/api/v1/collectors/350831942/sources/2763251087'
        Section9dELBS3LogsBucketName: 'akhilblogs-ap-southeast-1'
        Section9eELBS3BucketPathExpression: '*abc*'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.CloudWatchMetricsFirstStack
            - CreateCommonResources.CloudWatchMetricsSecondStack
            - CreateCommonResources.CloudWatchMetricsThirdStack.FirstCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsFirstStack.SecondCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsFirstStack.ThirdCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsSecondStack.SecondCloudwatchMetricsSource
            - CreateCommonResources.CloudWatchMetricsThirdStack
            - CreateCommonResources.CloudWatchMetricsThirdStack.SecondCloudwatchMetricsSource
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSTopic
            - CreateCommonResources.ALBSNSpolicy
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSTopic
            - CreateCommonResources.ELBSNSpolicy
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSTopic
            - CreateCommonResources.CloudTrailSNSpolicy
            - CreateCommonResources.CloudTrailSNSSubscription
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.InventorySource
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - CreateCommonResources.KinesisFirehoseLogsStack
            - CreateCommonResources.KinesisFirehoseLogsSource
            - CreateCommonResources.KinesisFirehoseLogsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.FailedDataBucket
            - CreateCommonResources.KinesisFirehoseLogsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroup
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStreamS3
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.SubscriptionFilter
            - AutoEnableOptions
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.InvokeLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTrigger
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTriggerPermission
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.sumoIAMPassRolePolicy
            - CreateCommonResources.CloudWatchEventFunction
            - CreateCommonResources.CloudWatchHTTPSource
            - CreateCommonResources.CloudWatchEventFunction.SumoCWDeadLetterQueue
            - CreateCommonResources.CloudWatchEventFunction.SumoCWEmailSNSTopic
            - CreateCommonResources.CloudWatchEventFunction.SumoCWEventsInvokeLambdaPermission
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLambdaExecutionRole
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLambdaPermission
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogGroup
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogSubsriptionFilter
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogsLambda
            - CreateCommonResources.CloudWatchEventFunction.SumoCWProcessDLQLambda
            - CreateCommonResources.CloudWatchEventFunction.SumoCWProcessDLQScheduleRule
            - CreateCommonResources.CloudWatchEventFunction.SumoCWSpilloverAlarm
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroupARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseLogsStack.FailedDataBucketArn
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - CreateCommonResources.CloudWatchLambdaARN
            - CreateCommonResources.CloudWatchEventFunction.SumoCWLogsLambdaArn
            - CreateCommonResources.CollectorName
            - CreateCommonResources.AccountAlias
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: "test8env"
            AccountAliasMappingS3URL: ""
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource: 'Yes'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SNS, AWS/SQS"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'No'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: ''
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'No'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: ''
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'No'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: ''
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'Yes'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'Yes'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
            CreateKinesisFirehoseMetricsSource: 'No'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
          CreateCommonResources.KinesisFirehoseLogsStack:
            Section2aCreateS3Bucket: 'Yes'
          AutoEnableOptions:
            ALBAutoEnableS3Logs: 'No'
            ELBAutoEnableS3Logs: 'No'
            AutoSubscribeLogGroups: 'Yes'
            AutoSubscribeLogGroupsOptions: 'Both'
            AutoSubscribeDestinationARNType: 'Kinesis'
            AutoSubscribeDestinationARNValue: 'arn:aws:firehose:'
            AutoSubscribeLogGroupPattern: 'lambda'
            AutoSubscribeRoleArn: "arn:aws:iam::"
          AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources:
            UseExistingLogs: 'true'
            DestinationArnType: 'Kinesis'
            DestinationArnValue: 'arn:aws:firehose:'
            LogGroupPattern: 'lambda'
            RoleArn: "arn:aws:iam::"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'No'
          sumoAlbMetricsAppStack:
            Section2aAccountAlias: 'test8env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoElbMetricsAppStack:
            Section2aAccountAlias: 'test8env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'No'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'No'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: 'test8env'
            Section3aInstallApp: 'No'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: '*cloudwatch-logs*'
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'No'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'

  - TestName: elbautoenablecheck
    Regions:
      - ap-southeast-1
    Skip: false
    Parameters:
      Values:
        Section1aSumoLogicDeployment: 'us2'
        Section1bSumoLogicAccessID: '${PROFESSIONAL_US2_ACCESS_ID}'
        Section1cSumoLogicAccessKey: '${PROFESSIONAL_US2_ACCESS_KEY}'
        Section1dSumoLogicOrganizationId: '${US2_PROFESSIONAL_ORG_ID}'
        Section2aAccountAlias: ''
        Section2bAccountAliasMappingS3URL: ''
        Section4bMetricsNameSpaces: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SNS, AWS/SQS, AWS/EC2'
        Section5aAutoEnableS3LogsALBResourcesOptions: 'Both'
        Section5bALBCreateLogSource: 'Yes'
        Section9aAutoEnableS3LogsELBResourcesOptions: 'Both'
        Section9bELBCreateLogSource: 'Yes'
    Assertions:
      - AssertType: ResourceExistence
        Assert:
          Resources:
            - LambdaRole
            - LambdaPermission
            - PrimerInvoke
            - TelemetryLambda
            - CreateCommonResources
            - AutoEnableOptions
            - sumoEC2MetricsAppStack
            - sumoAlbMetricsAppStack
            - sumoElbMetricsAppStack
            - sumoDynamoDBMetricsAppStack
            - sumoRdsMetricsAppStack
            - sumoApiGatewayMetricsAppStack
            - sumoSNSAppStack
            - sumoSQSAppStack
            - RootCauseAppStack
            - sumoLambdaMetricsAppStack
            - sumoECSMetricsAppStack
            - sumoElasticCacheMetricsAppStack
            - CreateCommonResources.AddAccountField
            - CreateCommonResources.AddRegionField
            - CreateCommonResources.AddNamespaceField
            - CreateCommonResources.AddApiIdField
            - CreateCommonResources.AddApiNameField
            - CreateCommonResources.AddCacheClusterIdField
            - CreateCommonResources.AddClusterNameField
            - CreateCommonResources.AddDBIdentifierField
            - CreateCommonResources.AddFunctionNameField
            - CreateCommonResources.AddInstanceIdField
            - CreateCommonResources.AddLoadBalancerField
            - CreateCommonResources.AddLoadBalancerNameField
            - CreateCommonResources.AddNETLoadBalancerField
            - CreateCommonResources.AddQueueNameField
            - CreateCommonResources.AddTableNameField
            - CreateCommonResources.AddTopicNameField
            - CreateCommonResources.LambdaRole
            - CreateCommonResources.LambdaHelper
            - CreateCommonResources.AccountCheck
            - CreateCommonResources.CommonBucketSNSTopic
            - CreateCommonResources.CommonS3Bucket
            - CreateCommonResources.CommonBucketPolicy
            - CreateCommonResources.CommonSNSpolicy
            - CreateCommonResources.CommonCloudTrail
            - CreateCommonResources.CreateSumoLogicAWSExplorerView
            - CreateCommonResources.SumoLogicSourceRole
            - CreateCommonResources.SumoLogicHostedCollector
            - CreateCommonResources.LambdaToDecideCWMetricsSources
            - CreateCommonResources.Primerinvoke
            - CreateCommonResources.KinesisFirehoseMetricsStack
            - CreateCommonResources.KinesisFirehoseMetricsSource
            - CreateCommonResources.KinesisFirehoseLogsStack
            - CreateCommonResources.KinesisFirehoseLogsSource
            - CreateCommonResources.KinesisFirehoseMetricsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroup
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStream
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogStreamS3
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRole
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRolePolicy
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambda
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsCloudWatchMetricsStreamLambdaRole
            - CreateCommonResources.KinesisFirehoseLogsStack.AttachBucketPolicyToFirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.FirehoseLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsFirehoseRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroup
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStream
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogStreamS3
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRole
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRolePolicy
            - CreateCommonResources.KinesisFirehoseLogsStack.SubscriptionFilter
            - CreateCommonResources.ALBSource
            - CreateCommonResources.ALBSNSSubscription
            - CreateCommonResources.ELBSource
            - CreateCommonResources.ELBSNSSubscription
            - CreateCommonResources.CloudTrailSource
            - CreateCommonResources.CloudTrailSNSSubscription
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.AutoEnableAlbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsInvokePermission
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.AutoEnableElbLogEventsRuleTrigger
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.ExistingAWSResources
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.SumoLambdaRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.InvokeLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupExistingLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTrigger
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorLambdaTriggerPermission
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnectorRole
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.sumoIAMPassRolePolicy
            - sumoEC2MetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoOverview
            - sumoEC2MetricsAppStack.sumoMonitorAlerts
            - sumoAlbMetricsAppStack.sumoApp
            - sumoElbMetricsAppStack.sumoApp
            - sumoDynamoDBMetricsAppStack.sumoApp
            - sumoRdsMetricsAppStack.ClusterMetricRule
            - sumoRdsMetricsAppStack.InstanceMetricRule
            - sumoRdsMetricsAppStack.sumoApp
            - sumoApiGatewayMetricsAppStack.sumoApp
            - sumoSNSAppStack.sumoApp
            - sumoSQSAppStack.sumoApp
            - sumoLambdaMetricsAppStack.sumoApp
            - sumoLambdaMetricsAppStack.LambdaFieldExtractionRule
            - sumoAlbMetricsAppStack.AlbLogsFieldExtractionRule
            - sumoElbMetricsAppStack.ElbLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.CloudTrailLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.AccessLogsFieldExtractionRule
            - sumoApiGatewayMetricsAppStack.MetricRule
            - sumoSNSAppStack.FieldExtractionRule
            - sumoSQSAppStack.FieldExtractionRule
            - sumoDynamoDBMetricsAppStack.FieldExtractionRule
            - sumoLambdaMetricsAppStack.LambdaCloudWatchLogsFieldExtractionRule
            - sumoLambdaMetricsAppStack.GenericCloudWatchLogsFieldExtractionRule
            - sumoRdsMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.FieldExtractionRule
            - sumoECSMetricsAppStack.sumoApp
            - sumoElasticCacheMetricsAppStack.FieldExtractionRule
            - sumoEC2MetricsAppStack.FieldExtractionRule
            - sumoElasticCacheMetricsAppStack.sumoApp
            - sumoNlbMetricsAppStack
            - sumoNlbMetricsAppStack.MetricRule
            - sumoNlbMetricsAppStack.sumoApp
            - sumoEC2MetricsAppStack.sumoAppCW
            - CreateCommonResources.AccountAliasValue
            - RootCauseAppStack.AccountAliasValue
            - RootCauseAppStack.LambdaHelper
            - RootCauseAppStack.LambdaRole
            - RootCauseAppStack.CloudTrailDevOps
            - RootCauseAppStack.InventorySource
            - RootCauseAppStack.RootCauseRole
            - RootCauseAppStack.SumoLogicHostedCollector
            - RootCauseAppStack.XraySource
            - sumoAlbMetricsAppStack.AccountAliasValue
            - sumoAlbMetricsAppStack.LambdaHelper
            - sumoAlbMetricsAppStack.LambdaRole
            - sumoElbMetricsAppStack.AccountAliasValue
            - sumoElbMetricsAppStack.LambdaHelper
            - sumoElbMetricsAppStack.LambdaRole
            - sumoLambdaMetricsAppStack.AccountAliasValue
            - CreateCommonResources.AddAccountIdField
            - CreateCommonResources.LambdaHelperAlias
            - CreateCommonResources.LambdaRoleAlias
            - CreateCommonResources.SumoLogicALBS3Policy
            - CreateCommonResources.SumoLogicELBS3Policy
            - CreateCommonResources.SumoLogicCloudTrailS3Policy
      - AssertType: OutputsCheck
        Assert:
          Outputs:
            - CreateCommonResources.LambdaHelperARN
            - CreateCommonResources.EnterpriseCheck
            - CreateCommonResources.PaidAccountCheck
            - CreateCommonResources.Namespaces
            - CreateCommonResources.LambdaRoleARN
            - CreateCommonResources.BucketName
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsAlbAWSResources.EnableNewAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableExisitngAWSResourcesLambda
            - AutoEnableOptions.AutoEnableS3LogsElbAWSResources.EnableNewAWSResourcesLambda
            - CreateCommonResources.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsLogGroupARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseLogsStack.KinesisLogsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsRoleARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsDeliveryStreamARN
            - CreateCommonResources.KinesisFirehoseMetricsStack.KinesisMetricsLogGroupARN
            - AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources.SumoLogGroupLambdaConnector
            - CreateCommonResources.AccountAlias
            - CreateCommonResources.CollectorName
      - AssertType: ParameterCheck
        Assert:
          CreateCommonResources:
            AccountAlias: ""
            AccountAliasMappingS3URL: ''
            CreateMetaDataSource: 'No'
            MetaDataSourceName: ""
            MetaDataSourceCategory: ""
            CreateCloudWatchMetricsSource:  'No'
            CloudWatchMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            CloudWatchMetricsNameSpaces: "AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SNS, AWS/SQS, AWS/EC2"
            ScanInterval: "30000"
            CloudWatchMetricSourceCategory: "aws/observability/cloudwatch/metrics"
            CreateKinesisFirehoseMetricsSource: 'Yes'
            KinesisFirehoseMetricsSourceName: 'cloudwatch-metrics-ap-southeast-1'
            KinesisFirehoseMetricSourceCategory: 'aws/observability/cloudwatch/metrics'
            CreateALBLogSource: 'Yes'
            CreateALBS3Bucket: 'Yes'
            ALBS3LogsBucketName: ""
            ALBS3BucketPathExpression: '/elasticloadbalancing/ap-southeast-1/*'
            ALBLogsSourceName: "alb-logs-ap-southeast-1"
            ALBLogsSourceCategory: "aws/observability/alb/logs"
            CreateELBLogSource: 'Yes'
            CreateELBS3Bucket: 'Yes'
            ELBS3LogsBucketName: ""
            ELBS3BucketPathExpression: '/elasticloadbalancing/ap-southeast-1/*'
            ELBLogsSourceName: "classic-lb-logs-ap-southeast-1"
            ELBLogsSourceCategory: "aws/observability/clb/logs"
            CreateCloudTrailLogSource: 'Yes'
            CreateCloudTrailBucket: 'Yes'
            CloudTrailLogsBucketName: ""
            CloudTrailBucketPathExpression: '/CloudTrail/ap-southeast-1/*'
            CloudTrailLogsSourceName: "cloudtrail-logs-ap-southeast-1"
            CloudTrailLogsSourceCategory: "aws/observability/cloudtrail/logs"
            CreateCloudWatchLogSource: 'No'
            CloudWatchLogsSourceName: "cloudwatch-logs-ap-southeast-1"
            CloudWatchLogsSourceCategory: "aws/observability/cloudwatch/logs"
            CreateKinesisFirehoseLogSource: 'Yes'
            KinesisFirehoseLogsSourceName: 'kinesis-firehose-cloudwatch-logs-ap-southeast-1'
            KinesisFirehoseLogsSourceCategory: 'aws/observability/cloudwatch/logs'
          CreateCommonResources.KinesisFirehoseMetricsStack:
            Section2aCreateS3Bucket: 'No'
            Section1bNamespaceFilter: 'AWS/ApiGateway, AWS/DynamoDB, AWS/ElastiCache, AWS/SNS, AWS/SQS'
          CreateCommonResources.KinesisFirehoseLogsStack:
            Section2aCreateS3Bucket: 'No'
          AutoEnableOptions:
            ALBAutoEnableS3Logs: 'Yes'
            ALBAutoEnableS3LogsOptions: "Both"
            ALBS3LogsBucketName: 'aws-observability-logs'
            ELBAutoEnableS3Logs: 'Yes'
            ELBAutoEnableS3LogsOptions: "Both"
            ELBS3LogsBucketName: 'aws-observability-logs'
            AutoSubscribeLogGroups: 'Yes'
            AutoSubscribeLogGroupsOptions: 'Both'
            AutoSubscribeDestinationARNType: 'Kinesis'
            AutoSubscribeDestinationARNValue: 'arn:aws:firehose:'
            AutoSubscribeLogGroupPattern: 'lambda'
            AutoSubscribeRoleArn: "arn:aws:iam::"
          AutoEnableOptions.AutoEnableS3LogsAlbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoEnableS3LogsElbAWSResources:
            BucketName: 'aws-observability-logs'
            AutoEnableResourceOptions: 'Both'
          AutoEnableOptions.AutoSubscribeLambdaLogGroupsAWSResources:
            UseExistingLogs: 'true'
            DestinationArnType: 'Kinesis'
            DestinationArnValue: 'arn:aws:firehose:'
            LogGroupPattern: 'lambda'
            RoleArn: "arn:aws:iam::"
          sumoEC2MetricsAppStack:
            Section2aInstallApp: 'Yes'
          sumoAlbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aALBLogsAPIUrl: ''
            Section5bALBLogsSourceName: '*alb-logs*'
          sumoElbMetricsAppStack:
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aELBLogsAPIUrl: ''
            Section5bELBLogsSourceName: '*elb-logs*'
          sumoDynamoDBMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoRdsMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoApiGatewayMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSNSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoSQSAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          RootCauseAppStack:
            Section2aInstallApp: 'Yes'
            Section2bCollectorName: ""
            Section3aCreateAwsInventorySource: 'Yes'
            Section3bAwsInventorySourceName: "inventory-ap-southeast-1"
            Section3dInventorySourceCategory: "aws/observability/inventory"
            Section4aCreateAwsXRaySource: 'Yes'
            Section4bAwsXRaySourceName: "xray-ap-southeast-1"
            Section4cXraySourceCategory: "aws/observability/xray"
          sumoLambdaMetricsAppStack:
            Section2aAccountAlias: ''
            Section3aInstallApp: 'Yes'
            Section4aCloudWatchExistingSourceAPIUrl: ''
            Section5aCloudTrailLogsAPIUrl: ''
            Section5bCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section6aCloudWatchLogsAPIUrl: ''
            Section6bCloudWatchLogsSourceName: '*cloudwatch-logs*'
          sumoECSMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoElasticCacheMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aCloudTrailLogsSourceName: '*cloudtrail-logs*'
            Section3bCloudTrailSourceUpdated: 'No'
          sumoNlbMetricsAppStack:
            Section2aInstallApp: 'Yes'
            Section3aNLBLogsSourceName: ''
            Section3bNLBSourceUpdated: 'No'